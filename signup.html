<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="stylesheet" href="dist\output.css" />
    <script src="https://cdn.tailwindcss.com"></script>
    <title>Sign Up</title>
  </head>
  <body>
    <section
      class="bg-gray-50 min-h-screen flex items-center justify-center bg-gradient-to-r from-cyan-500 to-blue-500"
    >
      <div class="bg-[#EBF2FA] flex rounded-2xl shadow-lg max-w-4xl p-5">
        <div class="md:w-1/2 px-8">
          <h2 class="font-bold text-2xl text-[#488AD6]">Sign Up</h2>
          <p class="text-sm mt-4 text-[#488AD6]">Sign up to get started</p>
          <form action="" class="flex flex-col gap-4">
            <input
              class="p-2 mt-8 rounded-xl border"
              type="text"
              id="fname"
              placeholder="First Name"
              required="required"
            />
            <input
              class="p-2 mt-1 rounded-xl border"
              type="text"
              id="lname"
              placeholder="Surname"
              required="required"
            />
            <input
              class="p-2 mt-1 rounded-xl border"
              type="email"
              id="email"
              placeholder="Email address"
              required="required"
            />
            <div class="relative">
              <input
                class="p-2 rounded-xl border w-full"
                type="password"
                id="password"
                placeholder="Password"
                required="required"
              />
              <svg
                xmlns="http://www.w3.org/2000/svg"
                width="16"
                height="16"
                fill="gray"
                class="bi bi-eye absolute top-1/2 right-3 -translate-y-1/2"
                viewBox="0 0 16 16"
              >
                <path
                  d="M16 8s-3-5.5-8-5.5S0 8 0 8s3 5.5 8 5.5S16 8 16 8zM1.173 8a13.133 13.133 0 0 1 1.66-2.043C4.12 4.668 5.88 3.5 8 3.5c2.12 0 3.879 1.168 5.168 2.457A13.133 13.133 0 0 1 14.828 8c-.058.087-.122.183-.195.288-.335.48-.83 1.12-1.465 1.755C11.879 11.332 10.119 12.5 8 12.5c-2.12 0-3.879-1.168-5.168-2.457A13.134 13.134 0 0 1 1.172 8z"
                />
                <path
                  d="M8 5.5a2.5 2.5 0 1 0 0 5 2.5 2.5 0 0 0 0-5zM4.5 8a3.5 3.5 0 1 1 7 0 3.5 3.5 0 0 1-7 0z"
                />
              </svg>
            </div>
            <button type="button" id="submitData" name="submitData" class="bg-[#488AD6] rounded-xl text-white py-2">
              Sign Up
            </button>
          </form>

          <div class="mt-10 grid grid-cols-3 items-center text-gray-400">
            <hr class="border-gray-400" />
            <p class="text-center text-sm">OR</p>
            <hr class="border-gray-400" />
          </div>
          <button
            id="google" class="text-sm hover:bg-[#488AD6] hover:text-white focus:outline-none focus:ring focus:ring-blue-300 bg-white border py-2 w-full rounded-xl mt-5 flex justify-center items-center"
          >
            <svg
              class="mr-3"
              xmlns="http://www.w3.org/2000/svg"
              width="25"
              height="25"
              fill="currentColor"
              class="bi bi-google"
              viewBox="0 0 16 16"
            >
              <path
                d="M15.545 6.558a9.42 9.42 0 0 1 .139 1.626c0 2.434-.87 4.492-2.384 5.885h.002C11.978 15.292 10.158 16 8 16A8 8 0 1 1 8 0a7.689 7.689 0 0 1 5.352 2.082l-2.284 2.284A4.347 4.347 0 0 0 8 3.166c-2.087 0-3.86 1.408-4.492 3.304a4.792 4.792 0 0 0 0 3.063h.003c.635 1.893 2.405 3.301 4.492 3.301 1.078 0 2.004-.276 2.722-.764h-.003a3.702 3.702 0 0 0 1.599-2.431H8v-3.08h7.545z"
              />
            </svg>
            Sign Up with Google
          </button>
          <!-- <p class="mt-5 text-xs border-b border-gray-400 py-4 hover:text-blue-500"><a href=''>Forgot your Password?</a></p> -->

          <div class="text-sm mt-3 flex justify-between items-center">
            <p>Already Signed up?</p>
            <button
            class="py-2 px-5 bg-white border rounded-xl hover:bg-[#488AD6] hover:text-white focus:outline-none focus:ring focus:ring-blue-300"
            ><a href="login.html">
              Log In</a>
            </button>
          </div>
        </div>
        <div class="md:block hidden w-1/2">
          <img
            class="rounded-2xl h-full"
            src="assets/img/login.jpg"
            alt="login image"
          />
        </div>
      </div>
    </section>



    <!-- script for firebase -->
    <script type="module">
        // Import the functions you need from the SDKs you need
        import { initializeApp } from "https://www.gstatic.com/firebasejs/9.15.0/firebase-app.js";
        import {getAuth,createUserWithEmailAndPassword,GoogleAuthProvider, signInWithPopup} from "https://www.gstatic.com/firebasejs/9.15.0/firebase-auth.js";
        import { getDatabase,set,ref} from "https://www.gstatic.com/firebasejs/9.15.0/firebase-database.js"
  
  
        // TODO: Add SDKs for Firebase products that you want to use
        // https://firebase.google.com/docs/web/setup#available-libraries
  
        // Your web app's Firebase configuration
        const firebaseConfig = {
            apiKey: "AIzaSyAyfLOGANgUcP40ZE3HL-30r4_PsTVXaUY",
            authDomain: "elt-express-web.firebaseapp.com",
            projectId: "elt-express-web",
            storageBucket: "elt-express-web.appspot.com",
            messagingSenderId: "383369967874",
            appId: "1:383369967874:web:957eb1d83915825ad36a1b",
          };
  
        // Initialize Firebase
        const app = initializeApp(firebaseConfig);
        const auth = getAuth();
        const database = getDatabase(app);
        const provider = new GoogleAuthProvider(app);

        google.addEventListener('click', (e) => {
            signInWithPopup(auth, provider)
  .then((result) => {
    // This gives you a Google Access Token. You can use it to access the Google API.
    const credential = GoogleAuthProvider.credentialFromResult(result);
    const token = credential.accessToken;
    // The signed-in user info.
    const user = result.user;
    email = email,
    photo = photoURL

    alert(user.displayName);
    // ...
  }).catch((error) => {
    // Handle Errors here.
    const errorCode = error.code;
    const errorMessage = error.message;
    // The email of the user's account used.
    const email = error.customData.email;
    // The AuthCredential type that was used.
    const credential = GoogleAuthProvider.credentialFromError(error);
    // ...
    alert(errorMessage);
  });


        } )
        
  
        submitData.addEventListener("click", (e) => {

          var fname = document.getElementById("fname").value;
          var lname = document.getElementById("lname").value;
          var email = document.getElementById("email").value;
          var password = document.getElementById("password").value;
          
          console.log(fname);
  
        createUserWithEmailAndPassword(auth, email, password)
            .then(async (userCredential) => {
              // Signed up
              const user = userCredential.user;
              // log to database and wait till its done
              return set(ref(database, 'users/' + user.uid), {
                email: email,
                fname: fname,
                lname: lname

              })
              .then(() => {
                // Data saved successfully!
                 alert("Account created. Please proceed to login.");
             
                 window.location.href = "login.html";
              })
              .catch((error) => {
                // The write failed...
                alert("Account could not be created");
            });

            })
        .catch((error) => {
              const errorCode = error.code;
              const errorMessage = error.message;
              // ...
              alert("Account could not be created");
            });
    
            });
  
   
      </script>
  </body>
</html>
